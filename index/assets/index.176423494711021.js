import{d as R,g as $,I as A,k as Q,m as U,Q as K,r as s,a4 as k,o as r,a as C,h as e,w as t,a5 as L,F as z,e as j,i as p,b as m,y as f,f as _,t as D,a0 as G,aa as H,A as J,O as W,N as X}from"./index.1764234947110.js";import{l as Y,b as Z}from"./dept.1764234947110.js";import{_ as ee}from"./editModule.vue_vue_type_script_setup_true_lang.17642349471103.js";import{t as te}from"./transListDataToTreeData.1764234947110.js";const ae={class:"app-container"},le={class:"card-header"},ie=R({__name:"index",setup(ne){const{proxy:y}=$(),v=A(),l=Q({loading:!0,title:"",tableData:[],statusOptions:[],queryParams:{search:void 0,status:void 0,pageSize:9999,page:1}}),c=()=>{l.loading=!0,Y(l.queryParams).then(n=>{l.tableData=te(n.data.data),l.loading=!1})},P=()=>{l.queryParams.search=void 0,l.queryParams.status=void 0,c()},q=n=>y.selectDictLabel(l.statusOptions,n.status),h=n=>{let a=n.id;n={},n.parentId=a,l.title="添加部门",v.value.openDialog(n)},B=n=>{l.title="修改部门",v.value.openDialog(n)},V=n=>{W({message:'是否确认删除名称为"'+n.dept_name+'"的数据项?',title:"警告",showCancelButton:!0,confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){return Z(n.id).then(()=>{c(),X.success("删除成功")})})};return U(()=>{c(),y.getDicts("sys_yes_no").then(n=>{l.statusOptions=n.data.data}),y.mittBus.on("onEditDeptModule",n=>{c()})}),K(()=>{y.mittBus.off("onEditDeptModule")}),(n,a)=>{const M=s("el-input"),g=s("el-form-item"),E=s("el-option"),I=s("el-select"),d=s("SvgIcon"),i=s("el-button"),O=s("el-form"),w=s("el-card"),u=s("el-table-column"),S=s("el-tag"),N=s("el-popover"),F=s("el-table"),b=k("auth"),T=k("loading");return r(),C("div",ae,[e(w,{shadow:"always"},{default:t(()=>[e(O,{model:l.queryParams,ref:"queryForm",inline:!0,"label-width":"68px"},{default:t(()=>[e(g,{label:"部门名称",prop:"deptName"},{default:t(()=>[e(M,{placeholder:"请输入部门名称模糊查询",clearable:"",onKeyup:L(c,["enter","native"]),modelValue:l.queryParams.search,"onUpdate:modelValue":a[0]||(a[0]=o=>l.queryParams.search=o)},null,8,["modelValue"])]),_:1}),e(g,{label:"状态",prop:"status"},{default:t(()=>[e(I,{modelValue:l.queryParams.status,"onUpdate:modelValue":a[1]||(a[1]=o=>l.queryParams.status=o),placeholder:"部门状态",clearable:"",style:{width:"180px"}},{default:t(()=>[(r(!0),C(z,null,j(l.statusOptions,o=>(r(),_(E,{key:o.dict_value,label:o.dict_label,value:o.dict_value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(g,null,{default:t(()=>[e(i,{type:"primary",plain:"",onClick:c},{default:t(()=>[e(d,{name:"elementSearch"}),a[2]||(a[2]=p(" 搜索 "))]),_:1}),e(i,{onClick:P},{default:t(()=>[e(d,{name:"elementRefresh"}),a[3]||(a[3]=p(" 重置 "))]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),e(w,{class:"box-card"},{header:t(()=>[m("div",le,[a[5]||(a[5]=m("span",{class:"card-header-text"},"部门列表",-1)),m("div",null,[f((r(),_(i,{type:"primary",plain:"",onClick:h},{default:t(()=>[e(d,{name:"elementPlus"}),a[4]||(a[4]=p(" 新增 "))]),_:1})),[[b,"system:dept:add"]])])])]),default:t(()=>[f((r(),_(F,{data:l.tableData,"row-key":"id",border:"","default-expand-all":"","tree-props":{children:"children",hasChildren:"hasChildren"}},{default:t(()=>[e(u,{prop:"dept_name",label:"部门名称",width:"260"}),e(u,{prop:"create_datetime",label:"创建时间",width:"200"},{default:t(o=>[m("span",null,D(G(H)(o.row.create_datetime)),1)]),_:1}),e(u,{prop:"sort",label:"排序",width:"100"}),e(u,{prop:"phone",label:"联系人电话",width:"200"}),e(u,{prop:"status",label:"状态",width:"100"},{default:t(o=>[e(S,{type:o.row.status==="1"?"danger":"success","disable-transitions":""},{default:t(()=>[p(D(q(o.row)),1)]),_:2},1032,["type"])]),_:1}),e(u,{label:"负责人",align:"center",prop:"leader",width:"200"}),e(u,{label:"操作",align:"center","class-name":"small-padding fixed-width",fixed:"right"},{default:t(o=>[e(N,{placement:"left"},{reference:t(()=>[e(i,{type:"primary",circle:""},{default:t(()=>[e(d,{name:"elementStar"})]),_:1})]),default:t(()=>[m("div",null,[f((r(),_(i,{text:"",type:"primary",onClick:x=>B(o.row)},{default:t(()=>[e(d,{name:"elementEdit"}),a[6]||(a[6]=p(" 修改 "))]),_:2},1032,["onClick"])),[[b,"system:dept:edit"]])]),m("div",null,[f((r(),_(i,{text:"",type:"primary",onClick:x=>h(o.row)},{default:t(()=>[e(d,{name:"elementPlus"}),a[7]||(a[7]=p(" 新增 "))]),_:2},1032,["onClick"])),[[b,"system:dept:add"]])]),m("div",null,[o.row.parentId!=0?f((r(),_(i,{key:0,text:"",type:"primary",onClick:x=>V(o.row)},{default:t(()=>[e(d,{name:"elementDelete"}),a[8]||(a[8]=p(" 删除 "))]),_:2},1032,["onClick"])),[[b,"system:dept:delete"]]):J("",!0)])]),_:2},1024)]),_:1})]),_:1},8,["data"])),[[T,l.loading]])]),_:1}),e(ee,{ref_key:"editModuleRef",ref:v,title:l.title},null,8,["title"])])}}});export{ie as default};
