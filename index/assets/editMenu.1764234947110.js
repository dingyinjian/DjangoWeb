import{K as T,ap as W,d as x,I as R,k as A,c as q,m as H,l as j,p as N,_ as z,r as p,o as i,a as V,h as t,w as l,f as F,B as P,b,t as w,A as I,F as E,e as D,g as J,a0 as K,N as U,a4 as G,y as Q,i as v}from"./index.1764234947110.js";import{t as X,u as Y,a as Z}from"./menu.1764234947110.js";const ee=()=>new Promise((e,o)=>{T(()=>{const u=document.styleSheets;let d=[],s=[];for(let a=0;a<u.length;a++)u[a].href&&u[a].href.indexOf("at.alicdn.com")>-1&&d.push(u[a]);for(let a=0;a<d.length;a++)for(let m=0;m<d[a].cssRules.length;m++)d[a].cssRules[m].selectorText&&d[a].cssRules[m].selectorText.indexOf(".icon-")>-1&&s.push(`${d[a].cssRules[m].selectorText.substring(1,d[a].cssRules[m].selectorText.length).replace(/\:\:before/gi,"")}`);s.length>0?e(s):o("未获取到值，请刷新重试")})}),le=()=>new Promise((e,o)=>{T(()=>{const u=W,d=[];for(const s in u)d.push(`element${u[s].name}`);d.length>0?e(d):o("未获取到值，请刷新重试")})}),oe=()=>new Promise((e,o)=>{T(()=>{const u=document.styleSheets;let d=[],s=[];for(let a=0;a<u.length;a++)u[a].href&&u[a].href.indexOf("netdna.bootstrapcdn.com")>-1&&d.push(u[a]);for(let a=0;a<d.length;a++)for(let m=0;m<d[a].cssRules.length;m++)d[a].cssRules[m].selectorText&&d[a].cssRules[m].selectorText.indexOf(".fa-")===0&&d[a].cssRules[m].selectorText.indexOf(",")===-1&&/::before/.test(d[a].cssRules[m].selectorText)&&s.push(`${d[a].cssRules[m].selectorText.substring(1,d[a].cssRules[m].selectorText.length).replace(/\:\:before/gi,"")}`);s.length>0?e(s.reverse()):o("未获取到值，请刷新重试")})}),$={ali:()=>ee(),ele:()=>le(),awe:()=>oe()},te=x({name:"iconSelector",emits:["update:modelValue","get","clear"],props:{prepend:{type:String,default:()=>"ele-Pointer"},placeholder:{type:String,default:()=>"请输入内容搜索图标或者选择图标"},size:{type:String,default:()=>"default"},title:{type:String,default:()=>"请选择图标"},type:{type:String,default:()=>"ele"},disabled:{type:Boolean,default:()=>!1},clearable:{type:Boolean,default:()=>!0},emptyDescription:{type:String,default:()=>"无相关图标"},modelValue:String},setup(e,{emit:o}){const u=R(),d=R(),s=A({fontIconPrefix:"",fontIconWidth:0,fontIconSearch:"",fontIconTabsIndex:0,fontIconSheetsList:[],fontIconPlaceholder:"",fontIconType:"ali",fontIconShow:!0}),a=()=>{if(!e.modelValue)return!1;s.fontIconSearch="",s.fontIconPlaceholder=e.modelValue},m=()=>{setTimeout(()=>{s.fontIconSheetsList.filter(y=>y===s.fontIconSearch).length<=0&&(s.fontIconSearch="")},300)},f=()=>{if(e.modelValue==="")return s.fontIconPlaceholder=e.placeholder;s.fontIconPlaceholder=e.modelValue,s.fontIconPrefix=e.modelValue},r=()=>{var h,y;((h=e.modelValue)==null?void 0:h.indexOf("iconfont"))>-1?g("ali"):((y=e.modelValue)==null?void 0:y.indexOf("ele-"))>-1?g("ele"):g("ali")},c=q(()=>{if(!s.fontIconSearch)return s.fontIconSheetsList;let h=s.fontIconSearch.trim().toLowerCase();return s.fontIconSheetsList.filter(y=>{if(y.toLowerCase().indexOf(h)!==-1)return y})}),_=()=>{T(()=>{s.fontIconWidth=u.value.$el.offsetWidth})},C=()=>{window.addEventListener("resize",()=>{_()})},O=async h=>{s.fontIconSheetsList=[],h==="ali"?await $.ali().then(y=>{s.fontIconSheetsList=y.map(L=>`iconfont ${L}`)}):h==="ele"&&await $.ele().then(y=>{s.fontIconSheetsList=y}),s.fontIconPlaceholder=e.placeholder,f()},g=h=>{s.fontIconType=h,O(h)},S=h=>{s.fontIconPlaceholder=h,s.fontIconPrefix=h,o("get",s.fontIconPrefix),o("update:modelValue",s.fontIconPrefix)},k=()=>{s.fontIconPrefix="",o("clear",s.fontIconPrefix),o("update:modelValue",s.fontIconPrefix)},B=()=>{f(),r()};return H(()=>{f(),C(),_()}),j(()=>e.modelValue,()=>{f()}),{inputWidthRef:u,selectorScrollbarRef:d,fontIconSheetsFilterList:c,onColClick:S,onIconChange:g,onClearFontIcon:k,onIconFocus:a,onIconBlur:m,onPopoverShow:B,...N(s)}}}),ne={class:"icon-selector w100 h100"},ue={class:"icon-selector-warp"},se={class:"icon-selector-warp-title flex"},ae={class:"flex-auto"},re={key:0,class:"icon-selector-warp-title-tab"},ie={class:"icon-selector-warp-row"},de={class:"flex-margin"},me={class:"icon-selector-warp-item-value"};function fe(e,o,u,d,s,a){const m=p("SvgIcon"),f=p("el-input"),r=p("el-col"),c=p("el-row"),_=p("el-empty"),C=p("el-scrollbar"),O=p("el-popover");return i(),V("div",ne,[t(O,{placement:"bottom",width:e.fontIconWidth,trigger:"click",transition:"el-zoom-in-top","popper-class":"icon-selector-popper",onShow:e.onPopoverShow},{reference:l(()=>[t(f,{modelValue:e.fontIconSearch,"onUpdate:modelValue":o[0]||(o[0]=g=>e.fontIconSearch=g),placeholder:e.fontIconPlaceholder,clearable:e.clearable,disabled:e.disabled,size:e.size,ref:"inputWidthRef",onClear:e.onClearFontIcon,onFocus:e.onIconFocus,onBlur:e.onIconBlur},{prepend:l(()=>{var g,S;return[(e.fontIconPrefix===""?((g=e.prepend)==null?void 0:g.indexOf("element"))>-1:((S=e.fontIconPrefix)==null?void 0:S.indexOf("element"))>-1)?(i(),F(m,{key:0,name:e.fontIconPrefix===""?e.prepend:e.fontIconPrefix,class:"font14"},null,8,["name"])):(i(),V("i",{key:1,class:P([e.fontIconPrefix===""?e.prepend:e.fontIconPrefix,"font14"])},null,2))]}),_:1},8,["modelValue","placeholder","clearable","disabled","size","onClear","onFocus","onBlur"])]),default:l(()=>[b("div",ue,[b("div",se,[b("div",ae,w(e.title),1),e.type==="all"?(i(),V("div",re,[b("span",{class:P([{"span-active":e.fontIconType==="ali"},"ml10"]),onClick:o[1]||(o[1]=g=>e.onIconChange("ali")),title:"iconfont 图标"},"ali",2),b("span",{class:P([{"span-active":e.fontIconType==="ele"},"ml10"]),onClick:o[2]||(o[2]=g=>e.onIconChange("ele")),title:"elementPlus 图标"},"ele",2)])):I("",!0)]),b("div",ie,[t(C,{ref:"selectorScrollbarRef"},{default:l(()=>[e.fontIconSheetsFilterList.length>0?(i(),F(c,{key:0,gutter:10},{default:l(()=>[(i(!0),V(E,null,D(e.fontIconSheetsFilterList,(g,S)=>(i(),F(r,{xs:6,sm:4,md:4,lg:4,xl:4,onClick:k=>e.onColClick(g),key:S},{default:l(()=>[b("div",{class:P(["icon-selector-warp-item",{"icon-selector-active":e.fontIconPrefix===g}])},[b("div",de,[b("div",me,[t(m,{name:g},null,8,["name"])])])],2)]),_:2},1032,["onClick"]))),128))]),_:1})):I("",!0),e.fontIconSheetsFilterList.length<=0?(i(),F(_,{key:1,"image-size":100,description:e.emptyDescription},null,8,["description"])):I("",!0)]),_:1},512)])])]),_:1},8,["width","onShow"])])}const ce=z(te,[["render",fe]]),pe={name:"editMenu",components:{IconSelector:ce},props:{title:{type:String,default:()=>""}},setup(){const{proxy:e}=J(),o=R(null),u=A({isShowDialog:!1,loading:!1,ruleForm:{id:0,menu_name:"",menu_type:"",parent:void 0,component:"",path:"",sort:1,status:"",title:"",icon:"",is_hide:"",is_keep_alive:"",is_affix:"",is_link:"",is_iframe:"",permission:"",remark:""},isHideOptions:[],statusOptions:[],menuTypeOptions:[],yesOrNoOptions:[],menuOptions:[],ruleRules:{menu_name:[{required:!0,message:"菜单名称不能为空",trigger:"blur"}],parent:[{required:!0,message:"父菜单不能为空",trigger:"blur"}],menu_type:[{required:!0,message:"菜单类型不能为空",trigger:"blur"}],status:[{required:!0,message:"菜单状态不能为空",trigger:"blur"}],sort:[{required:!0,message:"菜单顺序不能为空",trigger:"blur"}]}}),d=()=>{console.log(u.ruleForm.is_link)},s=r=>{u.ruleForm=JSON.parse(JSON.stringify(r)),u.isShowDialog=!0,u.loading=!1,e.getDicts("sys_show_hide").then(c=>{u.isHideOptions=c.data.data}),e.getDicts("sys_yes_no").then(c=>{u.statusOptions=c.data.data}),e.getDicts("sys_menu_type").then(c=>{u.menuTypeOptions=c.data.data}),e.getDicts("sys_num_yes_no").then(c=>{u.yesOrNoOptions=c.data.data}),X().then(c=>{u.menuOptions=[];const _={id:void 0,menu_name:"主类目",children:[]};_.children=c.data.data,u.menuOptions.push(_)})},a=r=>{e.mittBus.emit("onEditMenuModule",r),u.isShowDialog=!1};return{ruleFormRef:o,clear:d,openDialog:s,closeDialog:a,onCancel:()=>{a()},onSubmit:()=>{const r=K(o);r&&r.validate(c=>{c&&(u.ruleForm.component==""&&(u.ruleForm.menu_type=="F"?u.ruleForm.component="":u.ruleForm.component="Layout"),u.loading=!0,u.ruleForm.id!=null&&u.ruleForm.id!=0?Y(u.ruleForm).then(_=>{U.success("修改成功"),u.loading=!1,a()}):Z(u.ruleForm).then(_=>{U.success("新增成功"),u.loading=!1,a()}))})},...N(u)}}},Fe={class:"system-menu-container"},ge={style:{"font-size":"large"}},_e={class:"dialog-footer"};function he(e,o,u,d,s,a){const m=p("el-cascader"),f=p("el-form-item"),r=p("el-col"),c=p("el-radio"),_=p("el-radio-group"),C=p("el-input"),O=p("el-input-number"),g=p("IconSelector"),S=p("el-tooltip"),k=p("el-row"),B=p("el-alert"),h=p("el-form"),y=p("el-button"),L=p("el-dialog"),M=G("drag");return i(),V("div",Fe,[t(L,{modelValue:e.isShowDialog,"onUpdate:modelValue":o[15]||(o[15]=n=>e.isShowDialog=n),width:"769px",center:""},{header:l(()=>[Q((i(),V("div",ge,[v(w(u.title),1)])),[[M,[".system-menu-container .el-dialog",".system-menu-container .el-dialog__header"]]])]),footer:l(()=>[b("span",_e,[t(y,{onClick:d.onCancel},{default:l(()=>o[18]||(o[18]=[v("取 消")])),_:1},8,["onClick"]),t(y,{type:"primary",onClick:d.onSubmit,loading:e.loading},{default:l(()=>o[19]||(o[19]=[v("编 辑")])),_:1},8,["onClick","loading"])])]),default:l(()=>[t(h,{model:e.ruleForm,rules:e.ruleRules,ref:"ruleFormRef","label-width":"80px"},{default:l(()=>[t(k,{gutter:35},{default:l(()=>[t(r,{span:24},{default:l(()=>[t(f,{label:"上级菜单",prop:"parentId"},{default:l(()=>[t(m,{modelValue:e.ruleForm.parent,"onUpdate:modelValue":o[0]||(o[0]=n=>e.ruleForm.parent=n),options:e.menuOptions,class:"w100",props:{label:"menu_name",value:"id",checkStrictly:!0,emitPath:!1},clearable:"",filterable:"",placeholder:"选择上级菜单","show-all-levels":!1},null,8,["modelValue","options"])]),_:1})]),_:1}),t(r,{span:24},{default:l(()=>[t(f,{label:"菜单类型",prop:"menuType"},{default:l(()=>[t(_,{modelValue:e.ruleForm.menu_type,"onUpdate:modelValue":o[1]||(o[1]=n=>e.ruleForm.menu_type=n)},{default:l(()=>[(i(!0),V(E,null,D(e.menuTypeOptions,n=>(i(),F(c,{key:n.dict_value,label:n.dict_value},{default:l(()=>[v(w(n.dict_label),1)]),_:2},1032,["label"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1}),t(r,{xs:24,sm:12,md:12,lg:12,xl:12},{default:l(()=>[t(f,{label:"菜单名称",prop:"menuName"},{default:l(()=>[t(C,{modelValue:e.ruleForm.menu_name,"onUpdate:modelValue":o[2]||(o[2]=n=>e.ruleForm.menu_name=n),placeholder:"请输入菜单名称",clearable:""},null,8,["modelValue"])]),_:1})]),_:1}),t(r,{xs:24,sm:12,md:12,lg:12,xl:12},{default:l(()=>[t(f,{label:"菜单排序",prop:"sort"},{default:l(()=>[t(O,{modelValue:e.ruleForm.sort,"onUpdate:modelValue":o[3]||(o[3]=n=>e.ruleForm.sort=n),placeholder:"菜单排序",clearable:""},null,8,["modelValue"])]),_:1})]),_:1}),e.ruleForm.menu_type!="F"?(i(),F(r,{key:0,xs:24,sm:12,md:12,lg:12,xl:12},{default:l(()=>[t(f,{label:"菜单图标",prop:"icon"},{default:l(()=>[t(g,{placeholder:"请输入菜单图标",modelValue:e.ruleForm.icon,"onUpdate:modelValue":o[4]||(o[4]=n=>e.ruleForm.icon=n),type:"all"},null,8,["modelValue"])]),_:1})]),_:1})):I("",!0),t(r,{xs:24,sm:12,md:12,lg:12,xl:12},{default:l(()=>[t(k,{gutter:8},{default:l(()=>[t(r,{span:22},{default:l(()=>[t(f,{label:"权限标识",prop:"permission"},{default:l(()=>[t(C,{modelValue:e.ruleForm.permission,"onUpdate:modelValue":o[5]||(o[5]=n=>e.ruleForm.permission=n),placeholder:"路由权限标识",clearable:"",disabled:e.ruleForm.menu_type=="M"},null,8,["modelValue","disabled"])]),_:1})]),_:1}),t(r,{span:2},{default:l(()=>[t(S,{content:"路由权限标识（多个请用逗号隔开）",placement:"top"},{default:l(()=>o[16]||(o[16]=[b("i",{class:"fa fa-exclamation-circle ml10 mt10"},null,-1)])),_:1})]),_:1})]),_:1})]),_:1}),e.ruleForm.menu_type!="F"?(i(),F(r,{key:1,xs:24,sm:12,md:12,lg:12,xl:12},{default:l(()=>[t(k,{gutter:8},{default:l(()=>[t(r,{span:22},{default:l(()=>[t(f,{label:"组件地址"},{default:l(()=>[t(C,{modelValue:e.ruleForm.component,"onUpdate:modelValue":o[6]||(o[6]=n=>e.ruleForm.component=n),placeholder:"组件地址",clearable:""},null,8,["modelValue"])]),_:1})]),_:1}),t(B,{title:"若是目录以下有菜单，直接填写Layout，否则填写src/views下的文件夹地址，如/xx/xx/index",type:"info","show-icon":""})]),_:1})]),_:1})):I("",!0),e.ruleForm.menu_type!="F"?(i(),F(r,{key:2,xs:24,sm:12,md:12,lg:12,xl:12},{default:l(()=>[t(k,{gutter:8},{default:l(()=>[t(r,{span:22},{default:l(()=>[t(f,{label:"路由地址"},{default:l(()=>[t(C,{modelValue:e.ruleForm.path,"onUpdate:modelValue":o[7]||(o[7]=n=>e.ruleForm.path=n),placeholder:"请输入路由地址",clearable:""},null,8,["modelValue"])]),_:1})]),_:1}),t(B,{title:"浏览器中url的地址，请以/开头，要和页面name保持一致:例如 /system/role",type:"info","show-icon":""})]),_:1})]),_:1})):I("",!0),t(r,{xs:24,sm:12,md:12,lg:12,xl:12},{default:l(()=>[t(f,{label:"菜单状态",prop:"status"},{default:l(()=>[t(_,{modelValue:e.ruleForm.status,"onUpdate:modelValue":o[8]||(o[8]=n=>e.ruleForm.status=n)},{default:l(()=>[(i(!0),V(E,null,D(e.statusOptions,n=>(i(),F(c,{key:n.dict_value,label:n.dict_value},{default:l(()=>[v(w(n.dict_label),1)]),_:2},1032,["label"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1}),e.ruleForm.menu_type!="F"?(i(),F(r,{key:3,xs:24,sm:12,md:12,lg:12,xl:12},{default:l(()=>[t(f,{label:"是否隐藏"},{default:l(()=>[t(_,{modelValue:e.ruleForm.is_hide,"onUpdate:modelValue":o[9]||(o[9]=n=>e.ruleForm.is_hide=n)},{default:l(()=>[(i(!0),V(E,null,D(e.isHideOptions,n=>(i(),F(c,{key:n.dict_value,label:n.dict_value},{default:l(()=>[v(w(n.dict_label),1)]),_:2},1032,["label"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1})):I("",!0),e.ruleForm.menu_type!="F"?(i(),F(r,{key:4,xs:24,sm:12,md:12,lg:12,xl:12},{default:l(()=>[t(f,{label:"是否缓存"},{default:l(()=>[t(_,{modelValue:e.ruleForm.is_keep_alive,"onUpdate:modelValue":o[10]||(o[10]=n=>e.ruleForm.is_keep_alive=n)},{default:l(()=>[(i(!0),V(E,null,D(e.yesOrNoOptions,n=>(i(),F(c,{key:n.dict_value,label:n.dict_value},{default:l(()=>[v(w(n.dict_label),1)]),_:2},1032,["label"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1})):I("",!0),e.ruleForm.menu_type!="F"?(i(),F(r,{key:5,xs:24,sm:12,md:12,lg:12,xl:12},{default:l(()=>[t(k,{gutter:8},{default:l(()=>[t(r,{span:22},{default:l(()=>[t(f,{label:"是否固定"},{default:l(()=>[t(_,{modelValue:e.ruleForm.is_affix,"onUpdate:modelValue":o[11]||(o[11]=n=>e.ruleForm.is_affix=n)},{default:l(()=>[(i(!0),V(E,null,D(e.yesOrNoOptions,n=>(i(),F(c,{key:n.dict_value,label:n.dict_value},{default:l(()=>[v(w(n.dict_label),1)]),_:2},1032,["label"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1}),t(r,{span:2},{default:l(()=>[e.ruleForm.menu_type!="F"?(i(),F(S,{key:0,content:"是否要固定到tag头部",placement:"top"},{default:l(()=>o[17]||(o[17]=[b("i",{class:"fa fa-exclamation-circle ml10 mt10"},null,-1)])),_:1})):I("",!0)]),_:1})]),_:1})]),_:1})):I("",!0),e.ruleForm.menu_type!="F"?(i(),F(r,{key:6,xs:24,sm:12,md:12,lg:12,xl:12},{default:l(()=>[t(f,{label:"是否内嵌"},{default:l(()=>[t(_,{modelValue:e.ruleForm.is_iframe,"onUpdate:modelValue":o[12]||(o[12]=n=>e.ruleForm.is_iframe=n)},{default:l(()=>[(i(!0),V(E,null,D(e.yesOrNoOptions,n=>(i(),F(c,{key:n.dict_value,label:n.dict_value},{default:l(()=>[v(w(n.dict_label),1)]),_:2},1032,["label"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1})):I("",!0),e.ruleForm.menu_type!="F"?(i(),F(r,{key:7,xs:24,sm:12,md:12,lg:12,xl:12},{default:l(()=>[t(f,{label:"链接地址"},{default:l(()=>[t(C,{modelValue:e.ruleForm.is_link,"onUpdate:modelValue":o[13]||(o[13]=n=>e.ruleForm.is_link=n),placeholder:"外链/内嵌时链接地址（http:xxx.com）",clear:d.clear,clearable:""},null,8,["modelValue","clear"])]),_:1})]),_:1})):I("",!0),t(r,{xs:24,sm:24,md:24,lg:24,xl:24},{default:l(()=>[t(f,{label:"备注"},{default:l(()=>[t(C,{modelValue:e.ruleForm.remark,"onUpdate:modelValue":o[14]||(o[14]=n=>e.ruleForm.remark=n),placeholder:"请输入备注内容",clearable:"",type:"textarea"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue"])])}const Ie=z(pe,[["render",he]]);export{Ie as default};
