import{d as N,g as H,I as b,k as J,m as W,Q as X,r,a4 as D,o as i,a as h,h as t,w as l,F as S,e as M,a5 as Y,i as m,b as _,y,f as u,A as w,t as Z,z as ee,O as te,N as ae,_ as le}from"./index.1764234947110.js";import{b as ne,l as oe,d as re}from"./notice.1764234947110.js";import{_ as ie}from"./editModule.vue_vue_type_script_setup_true_lang.17642349471104.js";import se from"./viewModule.1764234947110.js";import"./dept.1764234947110.js";import"./role.1764234947110.js";import"./index.vue_vue_type_script_setup_true_name_wngEditor_lang.1764234947110.js";const de={class:"app-container"},ue={class:"card-header"},pe=N({name:"Notice"}),ce=N({...pe,setup(me){const{proxy:g}=H(),C=b(),k=b();b(null);const e=J({loading:!0,ids:[],single:!0,multiple:!0,title:"",tableData:[],total:0,open:!1,modelForm:{},noticeTypeOptions:[],queryParams:{page:1,pageSize:10,search:void 0,target_type:void 0},tabActive:"receive",tabOptions:[{value:"send",label:"我的发布"},{value:"receive",label:"我的接收"}],tab:!1}),d=()=>{e.loading=!0,e.tabActive==="send"?(e.tab=!1,ne(e.queryParams).then(n=>{e.tableData=n.data.data,e.total=n.data.total,e.loading=!1})):e.tabActive==="receive"&&(e.tab=!0,oe(e.queryParams).then(n=>{e.tableData=n.data.data,e.total=n.data.total,e.loading=!1}))},B=()=>{e.queryParams.search=void 0,e.queryParams.target_type=void 0,d()},T=n=>g.selectDictLabel(e.noticeTypeOptions,n.target_type),z=()=>{e.title="添加公告",C.value.openDialog({})},O=n=>{k.value.openDialog(n,e.noticeTypeOptions)},x=n=>{const a=n.id||e.ids;te({message:'是否确认删除公告编号为"'+a+'"的数据项?',title:"警告",showCancelButton:!0,confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){return re(a).then(()=>{d(),ae.success("删除成功")})})},A=n=>{e.ids=n.map(a=>a.id),e.single=n.length!=1,e.multiple=!n.length},R=n=>{e.queryParams.pageSize=n,d()},I=n=>{e.queryParams.page=n,d()};return W(()=>{d(),g.getDicts("sys_notice_type").then(n=>{e.noticeTypeOptions=n.data.data}),g.mittBus.on("onEditNoticeModule",()=>{d()})}),X(()=>{g.mittBus.off("onEditNoticeModule")}),(n,a)=>{const q=r("el-option"),P=r("el-select"),f=r("el-form-item"),E=r("el-input"),p=r("SvgIcon"),c=r("el-button"),F=r("el-form"),V=r("el-card"),s=r("el-table-column"),U=r("el-tag"),Q=r("el-popover"),$=r("el-table"),K=r("el-divider"),L=r("el-pagination"),v=D("auth"),j=D("loading");return i(),h("div",de,[t(V,{shadow:"always"},{default:l(()=>[t(F,{model:e.queryParams,ref:"queryForm",inline:!0,"label-width":"68px"},{default:l(()=>[t(f,{label:"信息类型",prop:"tabActive"},{default:l(()=>[t(P,{modelValue:e.tabActive,"onUpdate:modelValue":a[0]||(a[0]=o=>e.tabActive=o),placeholder:"请选择信息类型",style:{width:"140px"}},{default:l(()=>[(i(!0),h(S,null,M(e.tabOptions,o=>(i(),u(q,{key:o.value,label:o.label,value:o.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),t(f,{label:"信息标题",prop:"search"},{default:l(()=>[t(E,{placeholder:"请输入信息标题模糊查询",clearable:"",onKeyup:Y(d,["enter"]),style:{width:"240px"},modelValue:e.queryParams.search,"onUpdate:modelValue":a[1]||(a[1]=o=>e.queryParams.search=o)},null,8,["modelValue"])]),_:1}),t(f,{label:"通知类型",prop:"target_type"},{default:l(()=>[t(P,{modelValue:e.queryParams.target_type,"onUpdate:modelValue":a[2]||(a[2]=o=>e.queryParams.target_type=o),placeholder:"请选择通知类型",clearable:"",style:{width:"240px"}},{default:l(()=>[(i(!0),h(S,null,M(e.noticeTypeOptions,o=>(i(),u(q,{key:o.dict_value,label:o.dict_label,value:o.dict_value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),t(f,null,{default:l(()=>[t(c,{type:"primary",plain:"",onClick:d},{default:l(()=>[t(p,{name:"elementSearch"}),a[3]||(a[3]=m(" 搜索 "))]),_:1}),t(c,{onClick:B},{default:l(()=>[t(p,{name:"elementRefresh"}),a[4]||(a[4]=m(" 重置 "))]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),t(V,{class:"box-card"},{header:l(()=>[_("div",ue,[a[7]||(a[7]=_("span",{class:"card-header-text"},"信息列表",-1)),_("div",null,[y((i(),u(c,{type:"primary",plain:"",onClick:z},{default:l(()=>[t(p,{name:"elementPlus"}),a[5]||(a[5]=m(" 新增 "))]),_:1})),[[v,"system:notice:add"]]),e.tab?w("",!0):y((i(),u(c,{key:0,type:"danger",plain:"",disabled:e.multiple,onClick:x},{default:l(()=>[t(p,{name:"elementDelete"}),a[6]||(a[6]=m(" 删除 "))]),_:1},8,["disabled"])),[[v,"system:notice:delete"]])])])]),default:l(()=>[y((i(),u($,{data:e.tableData,onSelectionChange:A},{default:l(()=>[t(s,{type:"selection",width:"55",align:"center"}),t(s,{label:"通知编号",align:"center",prop:"id"}),e.tab?(i(),u(s,{key:0,label:"是否已读",align:"center",prop:"is_read"},{default:l(o=>[t(U,{type:o.row.is_read?"success":"danger"},{default:l(()=>[m(Z(o.row.is_read?"已读":"未读"),1)]),_:2},1032,["type"])]),_:1})):w("",!0),t(s,{label:"通知标题",align:"center",prop:"title","show-overflow-tooltip":!0}),t(s,{label:"通知类型",align:"center",prop:"target_type",formatter:T}),t(s,{label:"通知内容",align:"center",prop:"content","show-overflow-tooltip":!0}),t(s,{label:"通知时间",align:"center",prop:"create_datetime",width:"180"}),t(s,{label:"备注",align:"center",prop:"remark"}),t(s,{label:"操作",align:"center"},{default:l(o=>[t(Q,{placement:"left"},{reference:l(()=>[t(c,{type:"primary",circle:""},{default:l(()=>[t(p,{name:"elementStar"})]),_:1})]),default:l(()=>[_("div",null,[y((i(),u(c,{text:"",type:"primary",onClick:G=>O(o.row)},{default:l(()=>[t(p,{name:"elementView"}),a[8]||(a[8]=m(" 查看 "))]),_:2},1032,["onClick"])),[[v,"system:notice:view"]])]),_("div",null,[e.tab?w("",!0):y((i(),u(c,{key:0,text:"",type:"primary",onClick:G=>x(o.row)},{default:l(()=>[t(p,{name:"elementDelete"}),a[9]||(a[9]=m(" 删除 "))]),_:2},1032,["onClick"])),[[v,"system:notice:delete"]])])]),_:2},1024)]),_:1})]),_:1},8,["data"])),[[j,e.loading]]),y(_("div",null,[t(K),t(L,{background:"",total:e.total,"current-page":e.queryParams.page,"page-size":e.queryParams.pageSize,layout:"total, sizes, prev, pager, next, jumper",onSizeChange:R,onCurrentChange:I},null,8,["total","current-page","page-size"])],512),[[ee,e.total>0]])]),_:1}),t(ie,{ref_key:"editModuleRef",ref:C,title:e.title},null,8,["title"]),t(se,{ref_key:"viewModuleRef",ref:k},null,512)])}}});const we=le(ce,[["__scopeId","data-v-2e6657b7"]]);export{we as default};
