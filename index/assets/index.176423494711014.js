import{d as h,k as q,m as P,r as n,o as m,a as g,h as t,w as a,a5 as T,F as L,e as R,a9 as b,i as v,b as i,f as O}from"./index.1764234947110.js";import{S}from"./oper.1764234947110.js";const F={class:"system-user-container app-container"},M=["innerHTML"],N=["innerHTML"],B=h({name:"Systemlog"}),U=h({...B,setup(H){const e=q({activeTab:"server",loading:!0,logContent:"",queryParams:{type_log:"server",num_lines:void 0,keyword:void 0},numLinesOptions:[{dict_value:10,dict_label:"近10行"},{dict_value:50,dict_label:"近50行"},{dict_value:100,dict_label:"近100行"},{dict_value:500,dict_label:"近500行"}]}),r=()=>{e.loading=!0,S(e.queryParams).then(d=>{let l=d.data;const u=[{pattern:/\[INFO\]/gi,replacement:'<span class="highlight-info">[INFO]</span>'},{pattern:/\[ERROR\]/gi,replacement:'<span class="highlight-error">[ERROR]</span>'},{pattern:/(\[\d{4}-\d{2}-\d{2} \d{2}:\d{2}:\d{2},\d{3}\])/gi,replacement:'<span class="highlight-datetime">$1</span>'}];for(const{pattern:s,replacement:_}of u)l=l.replace(s,_);e.logContent=l,e.loading=!1})},k=()=>{e.queryParams.num_lines=void 0,e.queryParams.keyword=void 0,r()},w=d=>{e.logContent="",e.queryParams.type_log=d.props.name,r()};return P(()=>{r()}),(d,l)=>{const u=n("el-input"),s=n("el-form-item"),_=n("el-option"),x=n("el-select"),c=n("el-button"),C=n("el-form"),p=n("el-card"),y=n("el-scrollbar"),f=n("el-tab-pane"),V=n("el-tabs");return m(),g("div",F,[t(p,{shadow:"always"},{default:a(()=>[t(C,{model:e.queryParams,ref:"queryForm",inline:!0},{default:a(()=>[t(s,{label:"关键词",prop:"keyword"},{default:a(()=>[t(u,{size:"default",placeholder:"请输入关键词模糊查询",clearable:"",onKeyup:T(r,["enter"]),style:{width:"180px"},modelValue:e.queryParams.keyword,"onUpdate:modelValue":l[0]||(l[0]=o=>e.queryParams.keyword=o)},null,8,["modelValue"])]),_:1}),t(s,{label:"请求地址",prop:"num_lines"},{default:a(()=>[t(x,{modelValue:e.queryParams.num_lines,"onUpdate:modelValue":l[1]||(l[1]=o=>e.queryParams.num_lines=o),placeholder:"请选择查看日志行数",clearable:"",style:{width:"180px"}},{default:a(()=>[(m(!0),g(L,null,R(e.numLinesOptions,o=>(m(),O(_,{key:o.dict_value,label:o.dict_label,value:o.dict_value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),t(s,null,{default:a(()=>[t(c,{type:"primary",plain:"",onClick:r},{default:a(()=>[t(b,{name:"elementSearch"}),l[3]||(l[3]=v(" 搜索 "))]),_:1}),t(c,{onClick:k},{default:a(()=>[t(b,{name:"elementRefresh"}),l[4]||(l[4]=v(" 重置 "))]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),t(p,{class:"box-card"},{header:a(()=>l[5]||(l[5]=[i("div",{class:"card-header"},[i("span",{class:"card-header-text"},"系统日志")],-1)])),default:a(()=>[t(V,{type:"border-card",modelValue:e.activeTab,"onUpdate:modelValue":l[2]||(l[2]=o=>e.activeTab=o),onTabClick:w},{default:a(()=>[t(f,{label:"server.log",name:"server"},{default:a(()=>[t(y,{class:"log-content",style:{height:"600px"}},{default:a(()=>[i("pre",{innerHTML:e.logContent},null,8,M)]),_:1})]),_:1}),t(f,{label:"error.log",name:"error"},{default:a(()=>[t(y,{class:"log-content",style:{height:"600px"}},{default:a(()=>[i("pre",{innerHTML:e.logContent},null,8,N)]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})])}}});export{U as default};
