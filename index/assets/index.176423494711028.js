import{d as te,g as ae,I as le,k as oe,l as ne,m as se,ax as re,Q as de,r as s,a4 as k,o as d,a as q,h as t,w as o,b as m,a5 as ie,F as pe,e as ue,i,y as c,f as _,a0 as D,ay as me,t as S,aa as ce,z as _e,aq as fe,O,az as ge,N as ye,aA as he,_ as ve}from"./index.1764234947110.js";import{d as we}from"./dept.1764234947110.js";import be from"./editModule.176423494711011.js";import{h as xe}from"./export.1764234947110.js";import"./role.1764234947110.js";import"./post.1764234947110.js";const Ce={class:"system-user-container app-container"},Pe={class:"head-container"},ke={class:"head-container"},qe={class:"card-header"},De=te({__name:"index",setup(Se){const{proxy:f}=ae(),w=le(),e=oe({tableData:{data:[],total:0},loading:!1,postOptions:[],defaultProps:{children:"children",label:"dept_name"},sexOptions:[],roleOptions:[],statusOptions:[],dept_name:void 0,single:!0,multiple:!0,ids:[],title:"",deptOptions:void 0,queryParams:{page:1,pageSize:10,search:void 0,status:void 0,dept:void 0}});ne(()=>e.dept_name,a=>{f.$refs.tree.filter(a)});const h=async()=>{e.loading=!0,fe(e.queryParams).then(a=>{a.code!=200&&(e.loading=!1),e.tableData.data=a.data.data,e.tableData.total=a.data.total,e.loading=!1})},z=a=>{e.ids=a.map(l=>l.id),e.single=a.length!=1,e.multiple=!a.length},g=async()=>{e.queryParams.page=1,await h()},B=async()=>{e.queryParams.page=1,e.queryParams.pageSize=10,e.queryParams.search=void 0,e.queryParams.status=void 0,e.queryParams.dept=void 0,g()},V=()=>{e.title="添加用戶",w.value.openDialog({})},U=a=>{e.title="修改用户",w.value.openDialog(a)},E=async()=>{we().then(a=>{e.deptOptions=a.data})},C=a=>{const l=a.id||e.ids;O({message:'是否确认删除用户编号为"'+l+'"的数据项?',title:"警告",showCancelButton:!0,confirmButtonText:"确定",cancelButtonText:"取消"}).then(function(){return ge(l).then(()=>{h(),ye.success("删除成功")})})},F=a=>{e.queryParams.pageSize=a,g()},T=a=>{e.queryParams.page=a,g()},I=(a,l)=>a?l.dept_name.includes(a):!0,N=a=>{e.queryParams.dept=a.id,h(),e.queryParams.dept=0},M=()=>{O({message:"是否确认导出所有用户数据项?",title:"警告",confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){return he()}).then(a=>{let l=new Date().getTime()/1e3,v=parseInt(l)+"";xe(a,"用户表_"+v+".xls")})},L=(a,l)=>f.selectDictLabel(e.sexOptions,a.gender),A=a=>f.selectDictLabel(e.statusOptions,a.status);return se(()=>{h(),E(),re("sys_yes_no").then(a=>{e.statusOptions=a.data.data}),f.getDicts("sys_user_sex").then(a=>{e.sexOptions=a.data.data}),f.mittBus.on("onEditUserModule",a=>{g()})}),de(()=>{f.mittBus.off("onEditUserModule")}),(a,l)=>{const v=s("el-input"),Q=s("el-tree"),b=s("el-card"),P=s("el-col"),x=s("el-form-item"),R=s("el-option"),$=s("el-select"),p=s("SvgIcon"),u=s("el-button"),H=s("el-form"),r=s("el-table-column"),K=s("el-image"),j=s("el-tag"),G=s("el-popover"),J=s("el-table"),W=s("el-divider"),X=s("el-pagination"),Y=s("el-row"),y=k("auth"),Z=k("loading");return d(),q("div",Ce,[t(Y,{gutter:20},{default:o(()=>[t(P,{span:4,xs:24},{default:o(()=>[t(b,{shadow:"always"},{default:o(()=>[m("div",Pe,[t(v,{modelValue:e.dept_name,"onUpdate:modelValue":l[0]||(l[0]=n=>e.dept_name=n),placeholder:"请输入部门名称",clearable:"","prefix-icon":"el-icon-search",style:{"margin-bottom":"20px"}},null,8,["modelValue"])]),m("div",ke,[t(Q,{data:e.deptOptions,props:e.defaultProps,"node-key":"id","expand-on-click-node":!1,"filter-node-method":I,ref:"tree","default-expand-all":"",onNodeClick:N},null,8,["data","props"])])]),_:1})]),_:1}),t(P,{span:20,xs:24},{default:o(()=>[t(b,{shadow:"always"},{default:o(()=>[t(H,{model:e.queryParams,ref:"queryForm",inline:!0,"label-width":"78px"},{default:o(()=>[t(x,{label:"用户名称",prop:"username"},{default:o(()=>[t(v,{placeholder:"用户名称模糊查询",clearable:"",onKeyup:ie(g,["enter"]),style:{width:"240px"},modelValue:e.queryParams.search,"onUpdate:modelValue":l[1]||(l[1]=n=>e.queryParams.search=n)},null,8,["modelValue"])]),_:1}),t(x,{label:"状态",prop:"status"},{default:o(()=>[t($,{modelValue:e.queryParams.status,"onUpdate:modelValue":l[2]||(l[2]=n=>e.queryParams.status=n),placeholder:"用户状态",clearable:"",style:{width:"240px"}},{default:o(()=>[(d(!0),q(pe,null,ue(e.statusOptions,n=>(d(),_(R,{key:n.dict_alue,label:n.dict_label,value:n.dict_value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),t(x,null,{default:o(()=>[t(u,{type:"primary",plain:"",onClick:g},{default:o(()=>[t(p,{name:"elementSearch"}),l[3]||(l[3]=i(" 搜索 "))]),_:1}),t(u,{onClick:B},{default:o(()=>[t(p,{name:"elementRefresh"}),l[4]||(l[4]=i(" 重置 "))]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),t(b,{class:"box-card"},{header:o(()=>[m("div",qe,[l[8]||(l[8]=m("span",{class:"card-header-text"},"用户列表",-1)),m("div",null,[c((d(),_(u,{type:"primary",plain:"",onClick:V},{default:o(()=>[t(p,{name:"elementPlus"}),l[5]||(l[5]=i(" 新增 "))]),_:1})),[[y,"system:user:add"]]),c((d(),_(u,{type:"danger",plain:"",disabled:e.multiple,onClick:C},{default:o(()=>[t(p,{name:"elementDelete"}),l[6]||(l[6]=i(" 删除 "))]),_:1},8,["disabled"])),[[y,"system:user:delete"]]),c((d(),_(u,{type:"warning",plain:"",onClick:M},{default:o(()=>[t(p,{name:"elementDownload"}),l[7]||(l[7]=i(" 导出 "))]),_:1})),[[y,"system:user:export"]])])])]),default:o(()=>[c((d(),_(J,{data:e.tableData.data,stripe:"",onSelectionChange:z,style:{width:"100%"}},{default:o(()=>[t(r,{type:"selection",width:"45",align:"center"}),t(r,{label:"用户编号",align:"center",key:"userId",prop:"id"}),t(r,{label:"用户名",prop:"username","show-overflow-tooltip":""}),t(r,{label:"头像","show-overflow-tooltip":""},{default:o(n=>[t(K,{class:"system-user-photo",src:n.row.avatar?n.row.avatar:D(me)(n.row.username)},null,8,["src"])]),_:1}),t(r,{label:"用户性别",align:"center",prop:"gender",formatter:L}),t(r,{prop:"phone",label:"手机","show-overflow-tooltip":""}),t(r,{prop:"dept_name",label:"部门名称","show-overflow-tooltip":""}),t(r,{prop:"email",label:"邮箱","show-overflow-tooltip":""}),t(r,{label:"状态",align:"center",prop:"status"},{default:o(n=>[t(j,{type:n.row.status==="0"?"success":"danger","disable-transitions":""},{default:o(()=>[i(S(A(n.row)),1)]),_:2},1032,["type"])]),_:1}),t(r,{prop:"createTime",label:"创建时间","show-overflow-tooltip":""},{default:o(n=>[i(S(D(ce)(n.row.create_datetime)),1)]),_:1}),t(r,{prop:"path",align:"center",label:"操作",fixed:"right"},{default:o(n=>[t(G,{placement:"left"},{reference:o(()=>[t(u,{type:"primary",circle:""},{default:o(()=>[t(p,{name:"elementStar"})]),_:1})]),default:o(()=>[m("div",null,[c((d(),_(u,{text:"",type:"primary",onClick:ee=>U(n.row)},{default:o(()=>[t(p,{name:"elementEdit"}),l[9]||(l[9]=i(" 修改 "))]),_:2},1032,["onClick"])),[[y,"system:user:edit"]])]),m("div",null,[c((d(),_(u,{text:"",type:"primary",onClick:ee=>C(n.row)},{default:o(()=>[t(p,{name:"elementDelete"}),l[10]||(l[10]=i(" 删除 "))]),_:2},1032,["onClick"])),[[y,"system:user:delete"]])])]),_:2},1024)]),_:1})]),_:1},8,["data"])),[[Z,e.loading]]),c(m("div",null,[t(W),t(X,{background:"",total:e.tableData.total,"page-sizes":[10,20,30],"current-page":e.queryParams.page,"page-size":e.queryParams.pageSize,layout:"total, sizes, prev, pager, next, jumper",onSizeChange:F,onCurrentChange:T},null,8,["total","current-page","page-size"])],512),[[_e,e.tableData.total>0]])]),_:1})]),_:1})]),_:1}),t(be,{ref_key:"userFormRef",ref:w,title:e.title},null,8,["title"])])}}});const Fe=ve(De,[["__scopeId","data-v-ec0f450e"]]);export{Fe as default};
