import{d as z}from"./dept.1764234947110.js";import{d as H,g as L,I as F,k as W,r as d,a4 as $,o as n,a as i,h as t,w as a,y as j,i as c,t as O,b as G,f as p,A as I,F as v,e as x,av as K,a0 as Q,ah as X,N as U,aw as Z,_ as ee}from"./index.1764234947110.js";import{g as le}from"./role.1764234947110.js";import{g as oe}from"./post.1764234947110.js";const te={class:"system-menu-container"},ae={style:{"font-size":"large"}},se={class:"dialog-footer"},re=H({__name:"editModule",props:{title:{type:String,default:()=>""}},setup(S,{expose:D}){const{proxy:y}=L(),w=F(null),f=F(!1),_=F(!1),e=W({isShowDialog:!1,handleBeforeClose:!1,loading:!1,sexOptions:[],roleOptions:[],statusOptions:[],deptOptions:[],postOptions:[],ruleForm:{id:void 0,username:"",nickname:"",dept:"",role:[],post:[],phone:"",email:"",status:"",password:void 0,avatar:"",gender:"",remark:"",is_superuser:!1,is_staff:!1,postIds:"",roleIds:""},postIds:[],roleIds:[],isHideOptions:[],menuTypeOptions:[],yesOrNoOptions:[],menuOptions:[],ruleRules:{username:[{required:!0,message:"用户名称不能为空",trigger:"blur"}],nickname:[{required:!0,message:"用户昵称不能为空",trigger:"blur"}],password:[{required:!0,message:"用户密码不能为空",trigger:"blur"}],email:[{type:"email",message:"'请输入正确的邮箱地址",trigger:["blur","change"]}],phone:[{required:!0,pattern:/^1[3|4|5|6|7|8|9][0-9]\d{8}$/,message:"请输入正确的手机号码",trigger:"blur"}]}}),C=u=>{u&&u.id&&u.id!=null&&u.id!=0?K(u.id).then(l=>{e.ruleForm=l.data.data,e.postIds=l.data.data.post,e.roleIds=l.data.data.role,e.ruleForm.password=void 0,f.value=e.ruleForm.is_superuser,_.value=e.ruleForm.is_staff}):e.ruleForm=JSON.parse(JSON.stringify(u)),R(),e.isShowDialog=!0,e.loading=!1,le().then(l=>{e.roleOptions=l.data.roles}),oe().then(l=>{e.postOptions=l.data.posts}),y.getDicts("sys_user_sex").then(l=>{e.sexOptions=l.data.data}),y.getDicts("sys_yes_no").then(l=>{e.statusOptions=l.data.data})},g=()=>{e.isShowDialog=!1,f.value=!1,_.value=!1,e.postIds=[],e.roleIds=[]},N=()=>{g()},B=()=>{g()},R=async()=>{z().then(u=>{e.deptOptions=u.data})},q=()=>{const u=Q(w);u&&u.validate(l=>{l&&(e.ruleForm.post=e.postIds,e.ruleForm.role=e.roleIds,e.ruleForm.is_superuser=f.value,e.ruleForm.is_staff=_.value,e.loading=!0,e.ruleForm.id!=null?X(e.ruleForm).then(()=>{U.success("修改成功"),e.loading=!1,g()}):Z(e.ruleForm).then(()=>{U.success("新增成功"),e.loading=!1,g()}))})};return D({openDialog:C}),(u,l)=>{const m=d("el-input"),s=d("el-form-item"),r=d("el-col"),V=d("el-option"),b=d("el-select"),M=d("el-cascader"),T=d("el-radio"),A=d("el-radio-group"),h=d("el-switch"),E=d("el-row"),J=d("el-form"),k=d("el-button"),P=d("el-dialog"),Y=$("drag");return n(),i("div",te,[t(P,{modelValue:e.isShowDialog,"onUpdate:modelValue":l[13]||(l[13]=o=>e.isShowDialog=o),"before-close":N,width:"769px",center:""},{header:a(()=>[j((n(),i("div",ae,[c(O(S.title),1)])),[[Y,[".system-menu-container .el-dialog",".system-menu-container .el-dialog__header"]]])]),footer:a(()=>[G("span",se,[t(k,{onClick:B},{default:a(()=>l[14]||(l[14]=[c("取 消")])),_:1}),t(k,{type:"primary",onClick:q,loading:e.loading},{default:a(()=>l[15]||(l[15]=[c("编 辑")])),_:1},8,["loading"])])]),default:a(()=>[t(J,{ref_key:"ruleFormRef",ref:w,model:e.ruleForm,rules:e.ruleRules,"label-width":"100px"},{default:a(()=>[t(E,{gutter:35},{default:a(()=>[t(r,{xs:24,sm:12,md:12,lg:12,xl:12},{default:a(()=>[t(s,{label:"用户昵称",prop:"nickname"},{default:a(()=>[t(m,{modelValue:e.ruleForm.nickname,"onUpdate:modelValue":l[0]||(l[0]=o=>e.ruleForm.nickname=o),placeholder:"请输入用户昵称"},null,8,["modelValue"])]),_:1})]),_:1}),e.ruleForm.id==null?(n(),p(r,{key:0,xs:24,sm:12,md:12,lg:12,xl:12},{default:a(()=>[t(s,{label:"用户名称",prop:"username"},{default:a(()=>[t(m,{modelValue:e.ruleForm.username,"onUpdate:modelValue":l[1]||(l[1]=o=>e.ruleForm.username=o),placeholder:"请输入用户名称"},null,8,["modelValue"])]),_:1})]),_:1})):I("",!0),e.ruleForm.id==null?(n(),p(r,{key:1,xs:24,sm:12,md:12,lg:12,xl:12},{default:a(()=>[t(s,{label:"用户密码",prop:"password"},{default:a(()=>[t(m,{modelValue:e.ruleForm.password,"onUpdate:modelValue":l[2]||(l[2]=o=>e.ruleForm.password=o),placeholder:"请输入用户密码",type:"password"},null,8,["modelValue"])]),_:1})]),_:1})):I("",!0),t(r,{xs:24,sm:12,md:12,lg:12,xl:12},{default:a(()=>[t(s,{label:"手机号码",prop:"phone"},{default:a(()=>[t(m,{modelValue:e.ruleForm.phone,"onUpdate:modelValue":l[3]||(l[3]=o=>e.ruleForm.phone=o),placeholder:"请输入手机号码",maxlength:"11"},null,8,["modelValue"])]),_:1})]),_:1}),t(r,{xs:24,sm:12,md:12,lg:12,xl:12},{default:a(()=>[t(s,{label:"邮箱",prop:"email"},{default:a(()=>[t(m,{modelValue:e.ruleForm.email,"onUpdate:modelValue":l[4]||(l[4]=o=>e.ruleForm.email=o),placeholder:"请输入邮箱",maxlength:"50"},null,8,["modelValue"])]),_:1})]),_:1}),t(r,{xs:24,sm:12,md:12,lg:12,xl:12},{default:a(()=>[t(s,{label:"用户性别",prop:"gender"},{default:a(()=>[t(b,{modelValue:e.ruleForm.gender,"onUpdate:modelValue":l[5]||(l[5]=o=>e.ruleForm.gender=o),placeholder:"请选择"},{default:a(()=>[(n(!0),i(v,null,x(e.sexOptions,o=>(n(),p(V,{key:o.dict_value,label:o.dict_label,value:o.dict_value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1}),t(r,{xs:24,sm:12,md:12,lg:12,xl:12},{default:a(()=>[t(s,{label:"角色"},{default:a(()=>[t(b,{modelValue:e.roleIds,"onUpdate:modelValue":l[6]||(l[6]=o=>e.roleIds=o),multiple:"",placeholder:"请选择"},{default:a(()=>[(n(!0),i(v,null,x(e.roleOptions,o=>(n(),p(V,{key:o.id,label:o.role_name,value:o.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1}),t(r,{xs:24,sm:12,md:12,lg:12,xl:12},{default:a(()=>[t(s,{label:"归属部门",prop:"deptId"},{default:a(()=>[t(M,{modelValue:e.ruleForm.dept,"onUpdate:modelValue":l[7]||(l[7]=o=>e.ruleForm.dept=o),options:e.deptOptions,props:{label:"dept_name",value:"id",checkStrictly:!0,emitPath:!1},class:"w100",clearable:"",filterable:"",placeholder:"请选择归属部门","show-all-levels":!1},null,8,["modelValue","options"])]),_:1})]),_:1}),t(r,{xs:24,sm:12,md:12,lg:12,xl:12},{default:a(()=>[t(s,{label:"岗位"},{default:a(()=>[t(b,{modelValue:e.postIds,"onUpdate:modelValue":l[8]||(l[8]=o=>e.postIds=o),multiple:"",placeholder:"请选择"},{default:a(()=>[(n(!0),i(v,null,x(e.postOptions,o=>(n(),p(V,{key:o.id,label:o.post_name,value:o.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1}),t(r,{xs:24,sm:12,md:12,lg:12,xl:12},{default:a(()=>[t(s,{label:"状态"},{default:a(()=>[t(A,{modelValue:e.ruleForm.status,"onUpdate:modelValue":l[9]||(l[9]=o=>e.ruleForm.status=o)},{default:a(()=>[(n(!0),i(v,null,x(e.statusOptions,o=>(n(),p(T,{key:o.dict_value,label:o.dict_value},{default:a(()=>[c(O(o.dict_label),1)]),_:2},1032,["label"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1}),t(r,{xs:24,sm:12,md:12,lg:12,xl:12},{default:a(()=>[t(s,{label:"超级管理员"},{default:a(()=>[t(h,{modelValue:f.value,"onUpdate:modelValue":l[10]||(l[10]=o=>f.value=o),class:"ml-2","inline-prompt":"",style:{"--el-switch-on-color":"#13ce66","--el-switch-off-color":"#ff4949"},"active-text":"Y","inactive-text":"N"},null,8,["modelValue"])]),_:1})]),_:1}),t(r,{xs:24,sm:12,md:12,lg:12,xl:12},{default:a(()=>[t(s,{label:"后台登录权限"},{default:a(()=>[t(h,{modelValue:_.value,"onUpdate:modelValue":l[11]||(l[11]=o=>_.value=o),class:"ml-2","inline-prompt":"",style:{"--el-switch-on-color":"#13ce66","--el-switch-off-color":"#ff4949"},"active-text":"Y","inactive-text":"N"},null,8,["modelValue"])]),_:1})]),_:1}),t(r,{xs:24,sm:24,md:24,lg:24,xl:24},{default:a(()=>[t(s,{label:"备注"},{default:a(()=>[t(m,{modelValue:e.ruleForm.remark,"onUpdate:modelValue":l[12]||(l[12]=o=>e.ruleForm.remark=o),type:"textarea",placeholder:"请输入内容"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue"])])}}});const ie=ee(re,[["__scopeId","data-v-19ebe1e3"]]);export{ie as default};
