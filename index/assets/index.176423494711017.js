import{d as ee,g as te,I as S,k as le,m as ae,Q as ne,r,a4 as P,o as s,a as h,h as t,w as o,F as R,e as B,i as d,b as p,y as f,f as c,t as oe,A as re,z as se,a0 as ue,N as k,O as E}from"./index.1764234947110.js";import{_ as de,l as ie,d as me,c as pe,a as ce}from"./editModule.vue_vue_type_script_setup_true_name_editResEmails_lang.1764234947110.js";const ge={class:"app-container"},be={class:"card-header"},fe={class:"dialog-footer"},Ve=ee({__name:"index",setup(_e){const{proxy:_}=te(),C=S(),x=S(),e=le({loading:!0,debugOpen:!1,ids:[],single:!0,multiple:!0,title:"",tableData:[],total:0,statusOptions:[],mailOptions:[],debugForm:{to:"",subject:"",body:""},queryParams:{pageNum:1,pageSize:10,category:void 0,status:void 0},debugRules:{to:[{required:!0,message:"联系人不能为空",trigger:"blur"}],subject:[{required:!0,message:"主题不能为空",trigger:"blur"}],body:[{required:!0,message:"内容不能为空",trigger:"blur"}]}}),g=()=>{e.loading=!0,ie(e.queryParams).then(a=>{e.tableData=a.data.data,e.total=a.data.total,e.loading=!1})},M=()=>{e.queryParams.category=void 0,e.queryParams.status=void 0,g()},U=a=>{e.queryParams.pageNum=a,g()},z=a=>{e.queryParams.pageSize=a,g()},N=a=>_.selectDictLabel(e.mailOptions,a.category),T=()=>{e.title="添加ResEmails",C.value.openDialog({})},j=a=>{e.title="修改ResEmails",C.value.openDialog(a)},$=a=>{e.debugOpen=!0,e.debugForm.mailId=a.mailId},L=()=>{const a=ue(x);a&&a.validate(l=>{l&&me(e.debugForm).then(w=>{k.success("测试成功"),F()})})},F=()=>{e.debugOpen=!1,e.debugForm={}},Q=a=>{let l=a.status==="0"?"启用":"停用";E({message:'确认要"'+l+'""'+a.mailId+'"吗?',title:"警告",showCancelButton:!0,confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){return pe({mailId:a.mailId,status:a.status})}).then(()=>{k({message:l+"成功",type:"success"})}).catch(function(){a.status=a.status==="0"?"1":"0"})},q=a=>{const l=a.mailId||e.ids;E({message:'是否确认删除岗位编号为"'+l+'"的数据项?',title:"警告",showCancelButton:!0,confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){return ce(l).then(()=>{g(),k.success("删除成功")})})},A=a=>{e.ids=a.map(l=>l.mailId),e.single=a.length!=1,e.multiple=!a.length};return ae(()=>{g(),_.getDicts("sys_normal_disable").then(a=>{e.statusOptions=a.data}),_.getDicts("res_mail_category").then(a=>{e.mailOptions=a.data}),_.mittBus.on("onEditResEmailsModule",a=>{g()})}),ne(()=>{_.mittBus.off("onEditResEmailsModule")}),(a,l)=>{const w=r("el-option"),D=r("el-select"),b=r("el-form-item"),m=r("SvgIcon"),u=r("el-button"),I=r("el-form"),O=r("el-card"),i=r("el-table-column"),W=r("el-tag"),G=r("el-switch"),H=r("el-popover"),J=r("el-table"),K=r("el-divider"),X=r("el-pagination"),V=r("el-input"),Y=r("el-dialog"),y=P("auth"),Z=P("loading");return s(),h("div",ge,[t(O,{shadow:"always"},{default:o(()=>[t(I,{model:e.queryParams,ref:"queryForm",inline:!0,"label-width":"68px"},{default:o(()=>[t(b,{label:"分类",prop:"category"},{default:o(()=>[t(D,{modelValue:e.queryParams.category,"onUpdate:modelValue":l[0]||(l[0]=n=>e.queryParams.category=n),placeholder:"分类",clearable:""},{default:o(()=>[(s(!0),h(R,null,B(e.mailOptions,n=>(s(),c(w,{key:n.dictValue,label:n.dictLabel,value:n.dictValue},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),t(b,{label:"状态",prop:"status"},{default:o(()=>[t(D,{modelValue:e.queryParams.status,"onUpdate:modelValue":l[1]||(l[1]=n=>e.queryParams.status=n),placeholder:"状态",clearable:"",style:{width:"240px"}},{default:o(()=>[(s(!0),h(R,null,B(e.statusOptions,n=>(s(),c(w,{key:n.dictValue,label:n.dictLabel,value:n.dictValue},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),t(b,null,{default:o(()=>[t(u,{type:"primary",plain:"",onClick:g},{default:o(()=>[t(m,{name:"elementSearch"}),l[7]||(l[7]=d(" 搜索 "))]),_:1}),t(u,{onClick:M},{default:o(()=>[t(m,{name:"elementRefresh"}),l[8]||(l[8]=d(" 重置 "))]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),t(O,{class:"box-card"},{header:o(()=>[p("div",be,[l[11]||(l[11]=p("span",{class:"card-header-text"},"邮件列表",-1)),p("div",null,[f((s(),c(u,{type:"primary",plain:"",onClick:T},{default:o(()=>[t(m,{name:"elementPlus"}),l[9]||(l[9]=d(" 新增 "))]),_:1})),[[y,"resource:mail:add"]]),f((s(),c(u,{type:"danger",plain:"",disabled:e.multiple,onClick:q},{default:o(()=>[t(m,{name:"elementDelete"}),l[10]||(l[10]=d(" 删除 "))]),_:1},8,["disabled"])),[[y,"resource:mail:delete"]])])])]),default:o(()=>[f((s(),c(J,{data:e.tableData,onSelectionChange:A},{default:o(()=>[t(i,{type:"selection",width:"55",align:"center"}),t(i,{label:"编号",align:"center",prop:"mailId"}),t(i,{label:"分类",align:"center",width:"80",prop:"category"},{default:o(n=>[t(W,{type:n.row.category==="0"?"danger":n.row.category==="0"?"success":"warning","disable-transitions":""},{default:o(()=>[d(oe(N(n.row)),1)]),_:2},1032,["type"])]),_:1}),t(i,{label:"用户名称",align:"center",prop:"from"}),t(i,{label:"服务器地址",align:"center",width:"250",prop:"host"}),t(i,{label:"端口号",align:"center",prop:"port"}),t(i,{label:"发件人",align:"center",prop:"nickname"}),t(i,{label:"状态",align:"center"},{default:o(n=>[t(G,{modelValue:n.row.status,"onUpdate:modelValue":v=>n.row.status=v,"active-value":"0","inactive-value":"1",onClick:v=>Q(n.row)},null,8,["modelValue","onUpdate:modelValue","onClick"])]),_:1}),t(i,{label:"操作",align:"center",width:"300","class-name":"small-padding fixed-width"},{default:o(n=>[t(H,{placement:"left"},{reference:o(()=>[t(u,{type:"primary",circle:""},{default:o(()=>[t(m,{name:"elementStar"})]),_:1})]),default:o(()=>[p("div",null,[f((s(),c(u,{text:"",type:"primary",onClick:v=>j(n.row)},{default:o(()=>[t(m,{name:"elementEdit"}),l[12]||(l[12]=d(" 修改 "))]),_:2},1032,["onClick"])),[[y,"resource:mail:edit"]])]),p("div",null,[n.row.parentId!=0?f((s(),c(u,{key:0,text:"",type:"primary",onClick:v=>q(n.row)},{default:o(()=>[t(m,{name:"elementDelete"}),l[13]||(l[13]=d(" 删除 "))]),_:2},1032,["onClick"])),[[y,"resource:mail:delete"]]):re("",!0)]),p("div",null,[f((s(),c(u,{text:"",type:"primary",onClick:v=>$(n.row)},{default:o(()=>[t(m,{name:"elementUploadFilled"}),l[14]||(l[14]=d(" 调试 "))]),_:2},1032,["onClick"])),[[y,"resource:mail:debug"]])])]),_:2},1024)]),_:1})]),_:1},8,["data"])),[[Z,e.loading]]),f(p("div",null,[t(K),t(X,{background:"",total:e.total,"current-page":e.queryParams.pageNum,"page-size":e.queryParams.pageSize,layout:"total, sizes, prev, pager, next, jumper",onSizeChange:z,onCurrentChange:U},null,8,["total","current-page","page-size"])],512),[[se,e.total>0]])]),_:1}),t(de,{ref_key:"editModuleRef",ref:C,title:e.title},null,8,["title"]),t(Y,{title:"测试发送邮件",modelValue:e.debugOpen,"onUpdate:modelValue":l[6]||(l[6]=n=>e.debugOpen=n),width:"769px",center:""},{footer:o(()=>[p("span",fe,[t(u,{type:"primary",onClick:L},{default:o(()=>l[15]||(l[15]=[d("确 定")])),_:1}),t(u,{onClick:F},{default:o(()=>l[16]||(l[16]=[d("取 消")])),_:1})])]),default:o(()=>[t(I,{"label-width":"80px",model:e.debugForm,rules:e.debugRules,ref_key:"debugFormRef",ref:x},{default:o(()=>[t(b,{label:"邮箱编号"},{default:o(()=>[t(V,{modelValue:e.debugForm.mailId,"onUpdate:modelValue":l[2]||(l[2]=n=>e.debugForm.mailId=n),disabled:!0},null,8,["modelValue"])]),_:1}),t(b,{label:"联系人"},{default:o(()=>[t(V,{placeholder:"请输入要发送给谁",modelValue:e.debugForm.to,"onUpdate:modelValue":l[3]||(l[3]=n=>e.debugForm.to=n)},null,8,["modelValue"])]),_:1}),t(b,{label:"发送主题"},{default:o(()=>[t(V,{placeholder:"请输入发送主题",modelValue:e.debugForm.subject,"onUpdate:modelValue":l[4]||(l[4]=n=>e.debugForm.subject=n)},null,8,["modelValue"])]),_:1}),t(b,{label:"发送内容"},{default:o(()=>[t(V,{type:"textarea",placeholder:"请输入发送内容",modelValue:e.debugForm.body,"onUpdate:modelValue":l[5]||(l[5]=n=>e.debugForm.body=n)},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue"])])}}});export{Ve as default};
