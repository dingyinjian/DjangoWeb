import{d as K,g as $,I as j,k as G,m as L,Q as H,r,a4 as k,o as d,a as x,h as e,w as l,a5 as J,F as W,e as X,i as c,b as m,y as _,f as g,t as q,A as Y,z as Z,O as ee,N as te}from"./index.1764234947110.js";import{l as ae,d as le}from"./link.17642349471102.js";import ne from"./editModule.1764234947110.js";const oe={class:"app-container"},re={class:"card-header"},ue=K({__name:"index",setup(ie){const{proxy:h}=$(),v=j(),t=G({loading:!0,ids:[],single:!0,multiple:!0,title:"",tableData:[],total:0,categoryOptions:[],apiGroups:[],queryParams:{page:1,pageSize:10,category:void 0,search:void 0}}),s=()=>{t.loading=!0,ae(t.queryParams).then(n=>{t.tableData=n.data.data,t.total=n.data.total,t.loading=!1})},P=()=>{t.queryParams.category=void 0,t.queryParams.search=void 0,s()},D=()=>{t.title="添加",v.value.openDialog({})},S=n=>{t.title="修改Api参数",v.value.openDialog(n)},w=n=>{const a=n.id||t.ids;ee({message:'是否确认删除配置参数编号为"'+a+'"的数据项?',title:"警告",showCancelButton:!0,confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){return le(a).then(()=>{s(),te.success("删除成功")})})},V=n=>{t.ids=n.map(a=>a.id),t.single=n.length!=1,t.multiple=!n.length},z=n=>{t.queryParams.pageSize=n,s()},B=n=>{t.queryParams.page=n,s()};return L(()=>{console.log(121),s(),h.getDicts("link_category").then(n=>{t.categoryOptions=n.data.data})}),H(()=>{h.mittBus.off("onEditApiModule")}),(n,a)=>{const M=r("el-input"),b=r("el-form-item"),O=r("el-option"),E=r("el-select"),p=r("SvgIcon"),u=r("el-button"),A=r("el-form"),C=r("el-card"),i=r("el-table-column"),I=r("el-tag"),N=r("el-popover"),R=r("el-table"),T=r("el-divider"),F=r("el-pagination"),y=k("auth"),Q=k("loading");return d(),x("div",oe,[e(C,{shadow:"always"},{default:l(()=>[e(A,{model:t.queryParams,ref:"queryForm",inline:!0},{default:l(()=>[e(b,{label:"关键词",prop:"search"},{default:l(()=>[e(M,{placeholder:"标题 简介模糊查询",clearable:"",onKeyup:J(s,["enter"]),style:{width:"240px"},modelValue:t.queryParams.search,"onUpdate:modelValue":a[0]||(a[0]=o=>t.queryParams.search=o)},null,8,["modelValue"])]),_:1}),e(b,{label:"分类",prop:"category"},{default:l(()=>[e(E,{modelValue:t.queryParams.category,"onUpdate:modelValue":a[1]||(a[1]=o=>t.queryParams.category=o),placeholder:"分类",clearable:"",style:{width:"240px"}},{default:l(()=>[(d(!0),x(W,null,X(t.categoryOptions,o=>(d(),g(O,{key:o.dict_value,label:o.dict_label,value:o.dict_value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(b,null,{default:l(()=>[e(u,{type:"primary",plain:"",onClick:s},{default:l(()=>[e(p,{name:"elementSearch"}),a[2]||(a[2]=c(" 搜索 "))]),_:1}),e(u,{onClick:P},{default:l(()=>[e(p,{name:"elementRefresh"}),a[3]||(a[3]=c(" 重置 "))]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),e(C,{class:"box-card"},{header:l(()=>[m("div",re,[a[6]||(a[6]=m("span",{class:"card-header-text"},"添加",-1)),m("div",null,[_((d(),g(u,{type:"primary",plain:"",onClick:D},{default:l(()=>[e(p,{name:"elementPlus"}),a[4]||(a[4]=c(" 新增 "))]),_:1})),[[y,"system:api:add"]]),_((d(),g(u,{type:"danger",plain:"",disabled:t.multiple,onClick:w},{default:l(()=>[e(p,{name:"elementDelete"}),a[5]||(a[5]=c(" 删除 "))]),_:1},8,["disabled"])),[[y,"system:api:delete"]])])])]),default:l(()=>[_((d(),g(R,{data:t.tableData,onSelectionChange:V,border:""},{default:l(()=>[e(i,{type:"selection",width:"55",align:"center"}),e(i,{label:"ID",align:"center",prop:"id",width:"80"}),e(i,{label:"标题",align:"center",prop:"title","show-overflow-tooltip":!0}),e(i,{label:"链接地址",align:"center",prop:"url"}),e(i,{label:"分类",align:"center",prop:"category"},{default:l(o=>{var f;return[m("span",null,q((f=t.categoryOptions.find(U=>U.dict_value===o.row.category))==null?void 0:f.dict_label),1)]}),_:1}),e(i,{label:"简介",align:"center",prop:"description"}),e(i,{label:"是否启用",align:"center",prop:"is_active"},{default:l(o=>[e(I,{type:o.row.is_active?"success":"danger","disable-transitions":""},{default:l(()=>[c(q(o.row.is_active?"启用":"禁用"),1)]),_:2},1032,["type"])]),_:1}),e(i,{label:"所有者",align:"center",prop:"owner_name"}),e(i,{label:"操作",align:"center",width:"80","class-name":"medium-padding fixed-width",fixed:"right"},{default:l(o=>[e(N,{placement:"left"},{reference:l(()=>[e(u,{type:"primary",circle:""},{default:l(()=>[e(p,{name:"elementStar"})]),_:1})]),default:l(()=>[m("div",null,[_((d(),g(u,{text:"",type:"primary",onClick:f=>S(o.row)},{default:l(()=>[e(p,{name:"elementEdit"}),a[7]||(a[7]=c(" 修改 "))]),_:2},1032,["onClick"])),[[y,"system:api:edit"]])]),m("div",null,[o.row.parentId!=0?_((d(),g(u,{key:0,text:"",type:"primary",onClick:f=>w(o.row)},{default:l(()=>[e(p,{name:"elementDelete"}),a[8]||(a[8]=c(" 删除 "))]),_:2},1032,["onClick"])),[[y,"system:api:delete"]]):Y("",!0)])]),_:2},1024)]),_:1})]),_:1},8,["data"])),[[Q,t.loading]]),_(m("div",null,[e(T),e(F,{background:"",total:t.total,"current-page":t.queryParams.page,"page-size":t.queryParams.pageSize,layout:"total, sizes, prev, pager, next, jumper",onSizeChange:z,onCurrentChange:B},null,8,["total","current-page","page-size"])],512),[[Z,t.total>0]])]),_:1}),e(ne,{ref_key:"editModuleRef",ref:v,title:t.title,onOk:s},null,8,["title"])])}}});export{ue as default};
