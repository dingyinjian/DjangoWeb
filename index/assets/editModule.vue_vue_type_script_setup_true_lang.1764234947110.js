import{g as N,u as U,a as B}from"./api.1764234947110.js";import{d as q,g as G,I as R,k as E,r,a4 as M,o as s,a as n,h as t,w as a,y as J,i as d,t as _,b as z,F as g,e as c,a0 as L,N as y,f}from"./index.1764234947110.js";const T={class:"system-menu-container"},W={style:{"font-size":"large"}},j={class:"dialog-footer"},Q=q({__name:"editModule",props:{title:{type:String,default:()=>""}},setup(w,{expose:A}){const{proxy:b}=G(),h=R(null),e=E({isShowDialog:!1,loading:!1,ruleForm:{id:0,path:"",description:"",api_group:"",method:"",enable_datasource:"0"},methodOptions:[],enableOptions:[{dict_value:"0",dict_label:"需要"},{dict_value:"1",dict_label:"不需要"}],apiGroups:[],ruleRules:{path:[{required:!0,message:"API路径不能为空",trigger:"blur"}],api_group:[{required:!0,message:"API分组不能为空",trigger:"blur"}],method:[{required:!0,message:"API方法不能为空",trigger:"blur"}],enable_datasource:[{required:!0,message:"数据API是否需要鉴权为空",trigger:"blur"}]}}),D=i=>{e.ruleForm=JSON.parse(JSON.stringify(i)),e.isShowDialog=!0,e.loading=!1,b.getDicts("sys_method_api").then(o=>{e.methodOptions=o.data.data}),N().then(o=>{e.apiGroups=o.data.api_groups})},m=i=>{b.mittBus.emit("onEditApiModule",i),e.isShowDialog=!1},k=()=>{m()},x=()=>{const i=L(h);i&&i.validate(o=>{o&&(e.loading=!0,e.ruleForm.id!=null&&e.ruleForm.id!=0?U(e.ruleForm).then(p=>{y.success("修改成功"),e.loading=!1,m(e.ruleForm)}):B(e.ruleForm).then(p=>{y.success("新增成功"),e.loading=!1,m(e.ruleForm)}))})};return A({openDialog:D}),(i,o)=>{const p=r("el-input"),u=r("el-form-item"),I=r("el-option"),S=r("el-select"),F=r("el-radio"),V=r("el-radio-group"),P=r("el-form"),v=r("el-button"),C=r("el-dialog"),O=M("drag");return s(),n("div",T,[t(C,{modelValue:e.isShowDialog,"onUpdate:modelValue":o[5]||(o[5]=l=>e.isShowDialog=l),width:"769px",center:""},{header:a(()=>[J((s(),n("div",W,[d(_(w.title),1)])),[[O,[".app-container .el-dialog",".app-container .el-dialog__header"]]])]),footer:a(()=>[z("span",j,[t(v,{onClick:k},{default:a(()=>o[6]||(o[6]=[d("取 消")])),_:1}),t(v,{type:"primary",onClick:x,loading:e.loading},{default:a(()=>o[7]||(o[7]=[d("编 辑")])),_:1},8,["loading"])])]),default:a(()=>[t(P,{model:e.ruleForm,rules:e.ruleRules,ref_key:"ruleFormRef",ref:h,"label-width":"80px"},{default:a(()=>[t(u,{label:"路径",prop:"path"},{default:a(()=>[t(p,{modelValue:e.ruleForm.path,"onUpdate:modelValue":o[0]||(o[0]=l=>e.ruleForm.path=l),placeholder:"请输入路径"},null,8,["modelValue"])]),_:1}),t(u,{label:"API描述",prop:"description"},{default:a(()=>[t(p,{modelValue:e.ruleForm.description,"onUpdate:modelValue":o[1]||(o[1]=l=>e.ruleForm.description=l),placeholder:"请输入API描述"},null,8,["modelValue"])]),_:1}),t(u,{label:"API分组",prop:"api_group"},{default:a(()=>[t(S,{modelValue:e.ruleForm.api_group,"onUpdate:modelValue":o[2]||(o[2]=l=>e.ruleForm.api_group=l),placeholder:"请输入API分组",filterable:"",clearable:"","allow-create":"",style:{width:"240px"}},{default:a(()=>[(s(!0),n(g,null,c(e.apiGroups,l=>(s(),f(I,{key:l.api_group,label:l.api_group,value:l.api_group},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),t(u,{label:"方法名",prop:"method"},{default:a(()=>[t(V,{modelValue:e.ruleForm.method,"onUpdate:modelValue":o[3]||(o[3]=l=>e.ruleForm.method=l)},{default:a(()=>[(s(!0),n(g,null,c(e.methodOptions,l=>(s(),f(F,{key:l.dict_value,label:l.dict_value},{default:a(()=>[d(_(l.dict_label),1)]),_:2},1032,["label"]))),128))]),_:1},8,["modelValue"])]),_:1}),t(u,{label:"是否需要数据鉴权：",prop:"enable_datasource","label-width":"150px"},{default:a(()=>[t(V,{modelValue:e.ruleForm.enable_datasource,"onUpdate:modelValue":o[4]||(o[4]=l=>e.ruleForm.enable_datasource=l)},{default:a(()=>[(s(!0),n(g,null,c(e.enableOptions,l=>(s(),f(F,{key:l.dict_value,label:l.dict_value},{default:a(()=>[d(_(l.dict_label),1)]),_:2},1032,["label"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue"])])}}});export{Q as _};
