import{d as ee,g as te,I as le,k as ae,m as oe,Q as ne,r as s,a4 as q,o as r,a as w,h as t,w as n,a5 as se,F as D,e as B,i,b as p,y as _,f as g,t as re,A as de,z as ue,S as ie,O as I,N as C}from"./index.1764234947110.js";import{_ as pe,l as ce,c as me,d as ge}from"./editModule.vue_vue_type_script_setup_true_name_ediResOsses_lang.1764234947110.js";const _e={class:"app-container"},fe={class:"card-header"},Ce=ee({__name:"index",setup(ye){const{proxy:y}=te(),h=le(),R="http://36.133.79.38:8002",e=ae({loading:!0,debugOpen:!1,url:"",headers:{},ids:[],single:!0,multiple:!0,title:"",tableData:[],total:0,statusOptions:[],ossOptions:[],debugForm:{},queryParams:{pageNum:1,pageSize:10,category:void 0,ossCode:void 0,status:void 0}}),c=()=>{e.loading=!0,ce(e.queryParams).then(l=>{e.tableData=l.data.data,e.total=l.data.total,e.loading=!1})},U=()=>{e.queryParams.category=void 0,e.queryParams.ossCode=void 0,e.queryParams.status=void 0,c()},z=l=>{e.queryParams.pageNum=l,c()},F=l=>{e.queryParams.pageSize=l,c()},M=l=>y.selectDictLabel(e.ossOptions,l.category),N=()=>{e.title="添加ResOss",h.value.openDialog({})},$=l=>{e.title="修改ResOss",h.value.openDialog(l)},E=l=>{e.debugOpen=!0,e.debugForm=l,e.url=R+"/resource/oss/uploadFile?ossCode="+l.ossCode,e.headers={Authorization:`${ie.get("token")}`}},K=l=>{let a=l.status==="0"?"启用":"停用";I({message:'确认要"'+a+'""'+l.ossCode+'"Oss吗?',title:"警告",showCancelButton:!0,confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){return me({ossId:l.ossId,status:l.status})}).then(()=>{C({message:a+"成功",type:"success"})}).catch(function(){l.status=l.status==="0"?"1":"0"})},V=l=>{const a=l.ossId||e.ids;I({message:'是否确认删除岗位编号为"'+a+'"的数据项?',title:"警告",showCancelButton:!0,confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){return ge(a).then(()=>{c(),C.success("删除成功")})})},L=l=>{e.ids=l.map(a=>a.ossId),e.single=l.length!=1,e.multiple=!l.length},T=l=>{l.length>e.limit&&C.warning(`最大单次只可上传${e.limit}条`)},A=(l,a)=>{l.code==200?C.success(`文件上传成功，路径为${l.data}`):C.error("文件上传失败")};return oe(()=>{c(),y.getDicts("sys_normal_disable").then(l=>{e.statusOptions=l.data}),y.getDicts("res_oss_category").then(l=>{e.ossOptions=l.data}),y.mittBus.on("onEditResOssesModule",l=>{c()})}),ne(()=>{y.mittBus.off("onEditResOssesModule")}),(l,a)=>{const x=s("el-input"),f=s("el-form-item"),k=s("el-option"),O=s("el-select"),u=s("SvgIcon"),m=s("el-button"),P=s("el-form"),S=s("el-card"),d=s("el-table-column"),Q=s("el-tag"),j=s("el-switch"),G=s("el-popover"),H=s("el-table"),J=s("el-divider"),W=s("el-pagination"),X=s("el-upload"),Y=s("el-dialog"),b=q("auth"),Z=q("loading");return r(),w("div",_e,[t(S,{shadow:"always"},{default:n(()=>[t(P,{model:e.queryParams,ref:"queryForm",inline:!0,"label-width":"68px"},{default:n(()=>[t(f,{label:"资源编号",prop:"ossCode"},{default:n(()=>[t(x,{placeholder:"请输入资源编号糊查询",clearable:"",onKeyup:se(c,["enter"]),style:{width:"240px"},modelValue:e.queryParams.ossCode,"onUpdate:modelValue":a[0]||(a[0]=o=>e.queryParams.ossCode=o)},null,8,["modelValue"])]),_:1}),t(f,{label:"分类",prop:"category"},{default:n(()=>[t(O,{modelValue:e.queryParams.category,"onUpdate:modelValue":a[1]||(a[1]=o=>e.queryParams.category=o),placeholder:"分类",clearable:""},{default:n(()=>[(r(!0),w(D,null,B(e.ossOptions,o=>(r(),g(k,{key:o.dictValue,label:o.dictLabel,value:o.dictValue},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),t(f,{label:"状态",prop:"status"},{default:n(()=>[t(O,{modelValue:e.queryParams.status,"onUpdate:modelValue":a[2]||(a[2]=o=>e.queryParams.status=o),placeholder:"状态",clearable:"",style:{width:"240px"}},{default:n(()=>[(r(!0),w(D,null,B(e.statusOptions,o=>(r(),g(k,{key:o.dictValue,label:o.dictLabel,value:o.dictValue},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),t(f,null,{default:n(()=>[t(m,{type:"primary",plain:"",onClick:c},{default:n(()=>[t(u,{name:"elementSearch"}),a[5]||(a[5]=i(" 搜索 "))]),_:1}),t(m,{onClick:U},{default:n(()=>[t(u,{name:"elementRefresh"}),a[6]||(a[6]=i(" 重置 "))]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),t(S,{class:"box-card"},{header:n(()=>[p("div",fe,[a[9]||(a[9]=p("span",{class:"card-header-text"},"对象存储列表",-1)),p("div",null,[_((r(),g(m,{type:"primary",plain:"",onClick:N},{default:n(()=>[t(u,{name:"elementPlus"}),a[7]||(a[7]=i(" 新增 "))]),_:1})),[[b,"resource:file:add"]]),_((r(),g(m,{type:"danger",plain:"",disabled:e.multiple,onClick:V},{default:n(()=>[t(u,{name:"elementDelete"}),a[8]||(a[8]=i(" 删除 "))]),_:1},8,["disabled"])),[[b,"resource:file:delete"]])])])]),default:n(()=>[_((r(),g(H,{data:e.tableData,onSelectionChange:L},{default:n(()=>[t(d,{type:"selection",width:"55",align:"center"}),t(d,{label:"编号",align:"center",prop:"ossId"}),t(d,{label:"分类",align:"center",width:"80",prop:"category"},{default:n(o=>[t(Q,{type:o.row.category==="0"?"danger":o.row.category==="0"?"success":"warning","disable-transitions":""},{default:n(()=>[i(re(M(o.row)),1)]),_:2},1032,["type"])]),_:1}),t(d,{label:"资源编号",align:"center",prop:"ossCode"}),t(d,{label:"资源地址",align:"center",width:"250",prop:"endpoint"}),t(d,{label:"空间名",align:"center",prop:"bucketName"}),t(d,{label:"accessKey",align:"center",prop:"accessKey"}),t(d,{label:"secretKey",align:"center",prop:"secretKey"}),t(d,{label:"状态",align:"center"},{default:n(o=>[t(j,{modelValue:o.row.status,"onUpdate:modelValue":v=>o.row.status=v,"active-value":"0","inactive-value":"1",onClick:v=>K(o.row)},null,8,["modelValue","onUpdate:modelValue","onClick"])]),_:1}),t(d,{label:"操作",align:"center",width:"300","class-name":"small-padding fixed-width"},{default:n(o=>[t(G,{placement:"left"},{reference:n(()=>[t(m,{type:"primary",circle:""},{default:n(()=>[t(u,{name:"elementStar"})]),_:1})]),default:n(()=>[p("div",null,[_((r(),g(m,{text:"",type:"primary",onClick:v=>$(o.row)},{default:n(()=>[t(u,{name:"elementEdit"}),a[10]||(a[10]=i(" 修改 "))]),_:2},1032,["onClick"])),[[b,"resource:file:edit"]])]),p("div",null,[o.row.parentId!=0?_((r(),g(m,{key:0,text:"",type:"primary",onClick:v=>V(o.row)},{default:n(()=>[t(u,{name:"elementDelete"}),a[11]||(a[11]=i(" 删除 "))]),_:2},1032,["onClick"])),[[b,"resource:file:delete"]]):de("",!0)]),p("div",null,[_((r(),g(m,{text:"",type:"primary",onClick:v=>E(o.row)},{default:n(()=>[t(u,{name:"elementUploadFilled"}),a[12]||(a[12]=i(" 调试 "))]),_:2},1032,["onClick"])),[[b,"resource:file:debug"]])])]),_:2},1024)]),_:1})]),_:1},8,["data"])),[[Z,e.loading]]),_(p("div",null,[t(J),t(W,{background:"",total:e.total,"current-page":e.queryParams.pageNum,"page-size":e.queryParams.pageSize,layout:"total, sizes, prev, pager, next, jumper",onSizeChange:F,onCurrentChange:z},null,8,["total","current-page","page-size"])],512),[[ue,e.total>0]])]),_:1}),t(pe,{ref_key:"editModuleRef",ref:h,title:e.title},null,8,["title"]),t(Y,{title:"测试文件上传",modelValue:e.debugOpen,"onUpdate:modelValue":a[4]||(a[4]=o=>e.debugOpen=o),width:"769px",center:""},{default:n(()=>[t(P,{"label-width":"80px"},{default:n(()=>[t(f,{label:"资源编号"},{default:n(()=>[t(x,{modelValue:e.debugForm.ossCode,"onUpdate:modelValue":a[3]||(a[3]=o=>e.debugForm.ossCode=o),disabled:!0},null,8,["modelValue"])]),_:1}),t(f,{label:"上传文件"},{default:n(()=>[t(X,{drag:"",action:e.url,headers:e.headers,"auto-upload":!0,"on-exceed":T,"on-success":A},{default:n(()=>[t(u,{name:"elementPlus"}),a[13]||(a[13]=p("div",{class:"el-upload__text"},[i(" 拖拽文件到这或 "),p("em",null,"点击文件上传")],-1))]),_:1},8,["action","headers"])]),_:1})]),_:1})]),_:1},8,["modelValue"])])}}});export{Ce as default};
