import{a as B,b as N,u as L}from"./table.1764234947110.js";import{l as S}from"./type.1764234947110.js";import G from"./basicInfoForm.1764234947110.js";import j from"./genInfoForm.1764234947110.js";import{_ as q,g as O,I as F,k as z,p as P,r as m,o as p,f as v,w as t,N as k,b as _,h as e,i as E,a as C,e as R,F as D,t as g}from"./index.1764234947110.js";const Q={name:"genEdit",components:{BasicInfoForm:G,GenInfoForm:j},setup(){const{proxy:i}=O(),s=F(),V=F(),n=z({isShowDialog:!1,loading:!1,activeName:"cloum",columns:[],tableTree:[],dictOptions:[],info:{}}),T=a=>{a.tableId&&(B(a.tableId).then(d=>{let r=d.data.list.filter(w=>!["createTime","update_time","delete_time"].includes(w.columnName));n.columns=r,n.info=d.data.info,n.info.columns=n.columns,n.isShowDialog=!0}),n.loading=!1,S({pageNum:1,pageSize:100}).then(d=>{n.dictOptions=d.data.data}),N().then(d=>{n.tableTree=d.data,n.tableTree.length===0&&n.tableTree.unshift({tableId:0,className:"请选择"})}))},y=()=>{const a=V.value.basicInfoForm,d=s.value.genInfoFormRef;Promise.all([a,d].map(u)).then(r=>{if(r.every(b=>!!b)){const b=Object.assign({},V.value.info,s.value.info);b.columns=n.columns,n.loading=!0,L(b).then(U=>{k.success("修改成功"),n.loading=!1,f()})}else k.error("表单校验未通过，请重新检查提交内容")})},h=()=>{N().then(a=>{n.tableTree=a.data,n.tableTree.unshift({tableId:0,className:"请选择"})})},c=a=>n.tableTree.filter(function(d){if(d.tableName===a)return d.columns}),u=a=>new Promise(d=>{a.validate(r=>{d(r)})}),f=a=>{i.mittBus.emit("onEditTableModule",a),n.isShowDialog=!1};return{genInfoRef:s,basicInfoRef:V,openDialog:T,closeDialog:f,getTablesCol:c,getTables:h,submitForm:y,getFormPromise:u,...P(n)}}},K={style:{float:"left"}},M={style:{float:"right",color:"#8492a6","font-size":"13px"}},$={style:{float:"left"}},A={style:{float:"right",color:"#8492a6","font-size":"13px"}},H={class:"dialog-footer"};function J(i,s,V,n,T,y){const h=m("BasicInfoForm"),c=m("el-tab-pane"),u=m("el-table-column"),f=m("el-input"),a=m("el-option"),d=m("el-select"),r=m("el-checkbox"),w=m("el-table"),b=m("GenInfoForm"),U=m("el-tabs"),I=m("el-button"),x=m("el-dialog");return p(),v(x,{modelValue:i.isShowDialog,"onUpdate:modelValue":s[1]||(s[1]=l=>i.isShowDialog=l),title:"编辑表结构",width:"90%",center:""},{footer:t(()=>[_("span",H,[e(I,{type:"primary",onClick:n.submitForm,loading:i.loading},{default:t(()=>s[2]||(s[2]=[E("提交")])),_:1},8,["onClick","loading"]),e(I,{onClick:n.closeDialog},{default:t(()=>s[3]||(s[3]=[E("返回")])),_:1},8,["onClick"])])]),default:t(()=>[e(U,{modelValue:i.activeName,"onUpdate:modelValue":s[0]||(s[0]=l=>i.activeName=l)},{default:t(()=>[e(c,{label:"基本信息",name:"basic"},{default:t(()=>[e(h,{ref:"basicInfoRef",info:i.info},null,8,["info"])]),_:1}),e(c,{label:"字段信息",name:"cloum"},{default:t(()=>[e(w,{ref:"dragTable",data:i.columns,"row-key":"columnId",height:"450px"},{default:t(()=>[e(u,{label:"序号",type:"index",width:"50"}),e(u,{label:"字段列名",prop:"columnName",width:"150","show-overflow-tooltip":!0}),e(u,{fixed:"",label:"字段描述",width:"150"},{default:t(l=>[e(f,{modelValue:l.row.columnComment,"onUpdate:modelValue":o=>l.row.columnComment=o},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),e(u,{label:"物理类型",prop:"columnType",width:"120","show-overflow-tooltip":!0}),e(u,{label:"go类型",width:"120"},{default:t(l=>[e(d,{modelValue:l.row.goType,"onUpdate:modelValue":o=>l.row.goType=o},{default:t(()=>[e(a,{label:"int",value:"int"}),e(a,{label:"uint",value:"uint"}),e(a,{label:"int64",value:"int64"}),e(a,{label:"uint64",value:"uint64"}),e(a,{label:"float64",value:"float64"}),e(a,{label:"string",value:"string"}),e(a,{label:"Time",value:"Time"}),e(a,{label:"byte",value:"byte"})]),_:2},1032,["modelValue","onUpdate:modelValue"])]),_:1}),e(u,{label:"go属性",width:"150"},{default:t(l=>[e(f,{modelValue:l.row.goField,"onUpdate:modelValue":o=>l.row.goField=o},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),e(u,{label:"json属性",width:"150"},{default:t(l=>[e(f,{modelValue:l.row.jsonField,"onUpdate:modelValue":o=>l.row.jsonField=o},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),e(u,{label:"插入",width:"50"},{default:t(l=>[e(r,{modelValue:l.row.isInsert,"onUpdate:modelValue":o=>l.row.isInsert=o,"true-label":"1","false-label":"0"},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),e(u,{label:"编辑",width:"70","cell-style":{"text-align":"center"}},{default:t(l=>[e(r,{modelValue:l.row.isEdit,"onUpdate:modelValue":o=>l.row.isEdit=o,"true-label":"1","false-label":"0"},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),e(u,{label:"列表",width:"70","cell-style":{"text-align":"center"}},{default:t(l=>[e(r,{modelValue:l.row.isList,"onUpdate:modelValue":o=>l.row.isList=o,"true-label":"1","false-label":"0"},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),e(u,{label:"查询",width:"70","cell-style":{"text-align":"center"}},{default:t(l=>[e(r,{modelValue:l.row.isQuery,"onUpdate:modelValue":o=>l.row.isQuery=o,"true-label":"1","false-label":"0"},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),e(u,{label:"必填",width:"50"},{default:t(l=>[e(r,{modelValue:l.row.isRequired,"onUpdate:modelValue":o=>l.row.isRequired=o,"true-label":"1","false-label":"0"},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),e(u,{label:"查询方式",width:"120"},{default:t(l=>[e(d,{modelValue:l.row.queryType,"onUpdate:modelValue":o=>l.row.queryType=o},{default:t(()=>[e(a,{label:"=",value:"EQ"}),e(a,{label:"!=",value:"NE"}),e(a,{label:">",value:"GT"}),e(a,{label:">=",value:"GTE"}),e(a,{label:"<",value:"LT"}),e(a,{label:"<=",value:"LTE"}),e(a,{label:"LIKE",value:"LIKE"})]),_:2},1032,["modelValue","onUpdate:modelValue"])]),_:1}),e(u,{label:"显示类型",width:"140"},{default:t(l=>[e(d,{modelValue:l.row.htmlType,"onUpdate:modelValue":o=>l.row.htmlType=o},{default:t(()=>[e(a,{label:"文本框",value:"input"}),e(a,{label:"下拉框",value:"select"}),e(a,{label:"开关",value:"switch"}),e(a,{label:"单选框",value:"radio"}),e(a,{label:"多选框",value:"checkbox"}),e(a,{label:"文件选择",value:"file"}),e(a,{label:"文本域",value:"textarea"}),e(a,{label:"日期控件",value:"datetime"})]),_:2},1032,["modelValue","onUpdate:modelValue"])]),_:1}),e(u,{label:"字典类型",width:"160"},{default:t(l=>[e(d,{modelValue:l.row.dictType,"onUpdate:modelValue":o=>l.row.dictType=o,clearable:"",filterable:"",placeholder:"请选择"},{default:t(()=>[(p(!0),C(D,null,R(i.dictOptions,o=>(p(),v(a,{key:o.dictType,label:o.dictName,value:o.dictType},{default:t(()=>[_("span",K,g(o.dictName),1),_("span",M,g(o.dictType),1)]),_:2},1032,["label","value"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue"])]),_:1}),e(u,{label:"关系表",width:"160"},{default:t(l=>[e(d,{modelValue:l.row.linkTableName,"onUpdate:modelValue":o=>l.row.linkTableName=o,clearable:"",filterable:"",placeholder:"请选择"},{default:t(()=>[(p(!0),C(D,null,R(i.tableTree,o=>(p(),v(a,{key:o.tableName,label:o.tableName,value:o.tableName},{default:t(()=>[_("span",$,g(o.tableName),1),_("span",A,g(o.tableComment),1)]),_:2},1032,["label","value"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue"])]),_:1})]),_:1},8,["data"])]),_:1}),e(c,{label:"生成信息",name:"genInfo"},{default:t(()=>[e(b,{ref:"genInfoRef",info:i.info},null,8,["info"])]),_:1})]),_:1},8,["modelValue"])]),_:1},8,["modelValue"])}const le=q(Q,[["render",J]]);export{le as default};
